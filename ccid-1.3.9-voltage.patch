diff -up ./src/commands.c.voltage ./src/commands.c
--- ./src/commands.c.voltage	2008-11-18 13:48:42.000000000 -0800
+++ ./src/commands.c	2012-10-15 08:58:08.127440000 -0700
@@ -83,6 +83,7 @@ RESPONSECODE CmdPowerOn(unsigned int rea
 	status_t res;
 	int length, count = 1;
 	unsigned int atr_len;
+	int init_voltage = 0;
 	RESPONSECODE return_value = IFD_SUCCESS;
 	_ccid_descriptor *ccid_descriptor = get_ccid_descriptor(reader_index);
 
@@ -171,6 +172,7 @@ RESPONSECODE CmdPowerOn(unsigned int rea
 
 	if (ccid_descriptor->dwFeatures & CCID_CLASS_AUTO_VOLTAGE)
 		voltage = 0;	/* automatic voltage selection */
+	init_voltage = voltage;
 
 again:
 	cmd[0] = 0x62; /* IccPowerOn */
@@ -222,14 +224,19 @@ again:
 		}
 
 		/* continue with 3 volts and 5 volts */
-		if (voltage > 1)
+		if (voltage) 
 		{
 			const char *voltage_code[] = { "auto", "5V", "3V", "1.8V" };
 
 			DEBUG_INFO3("Power up with %s failed. Try with %s.",
 				voltage_code[voltage], voltage_code[voltage-1]);
 			voltage--;
-			goto again;
+			if (voltage == 0) {
+			    voltage = 3;
+			}
+			if (voltage != init_voltage) {
+			    goto again;
+			}
 		}
 
 		return IFD_COMMUNICATION_ERROR;
